<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Functions that read some of the raw data formats
    produced by Google electron microscopy segmentation tools as displayed
    by neuroglancer and then allow basic 3D visualisation and analysis.">
<title>Support Functions for Analysis of FAFB EM Segmentation • fafbseg</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Support Functions for Analysis of FAFB EM Segmentation">
<meta property="og:description" content="Functions that read some of the raw data formats
    produced by Google electron microscopy segmentation tools as displayed
    by neuroglancer and then allow basic 3D visualisation and analysis.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">fafbseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/FAFB-FlyWire.html">FAFB-FlyWire</a>
    <a class="dropdown-item" href="articles/accessing-graphene-server.html">Accessing the chunked graph server</a>
    <a class="dropdown-item" href="articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a>
    <a class="dropdown-item" href="articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a>
    <a class="dropdown-item" href="articles/mesh-to-mesh.html">Mesh to mesh distances</a>
    <a class="dropdown-item" href="articles/fafbseg-catmaid-legacy-info.html">fafbseg-catmaid-legacy-info</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="SUPPORT.html">Help</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://natverse.org/">natverse</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/natverse/fafbseg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="fafbseg">fafbseg<a class="anchor" aria-label="anchor" href="#fafbseg"></a>
</h1></div>
<p>The goal of fafbseg is to provide support for analysis of segmented EM data, focussed on the <a href="http://temca2data.org/" class="external-link">full adult female brain (FAFB) dataset</a>.</p>
<p>Although there is support for a range of data sources and services, at this point the principal target is the <a href="https://flywire.ai/" class="external-link">FlyWire</a> automated segmentation. Legacy support also exists for the <a href="http://fafb-ffn1.storage.googleapis.com/landing.html" class="external-link">Google brain</a> automatic segmentation of FAFB data.</p>
<p><strong>fafbseg</strong> is integrated with the <a href="https://github.com/natverse/nat" class="external-link">NeuroAnatomy Toolbox</a> suite (aka <a href="http://natverse.org" class="external-link">natverse</a>) including <a href="https://github.com/natverse/elmr" class="external-link">elmr</a> and <a href="https://github.com/natverse/rcatmaid" class="external-link">catmaid</a>.</p>
<p><strong>fafbseg</strong> is also one building block for the <a href="https://natverse.org/coconatfly/" class="external-link">coconatfly</a> which provides a unified and simplified interface to a range of Drosophila connectome datasets. We actually recommend <a href="https://natverse.org/coconatfly/" class="external-link">coconatfly</a> as a good place to start for most users since it provides convenient access to specific FlyWire data releases as well as powerful cross-connectome analyses while requiring minimal configuration. See <a href="https://natverse.org/coconatfly/articles/getting-started.html" class="external-link uri">https://natverse.org/coconatfly/articles/getting-started.html</a> for details.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Assuming you want to use the production (in progress) version of the FlyWire dataset or to access lower level functionality, then fafbseg is the way to go. You will need to install the package and then configure your environment including recording your authorisation token and likely downloading canned data releases.</p>
<div class="section level3">
<h3 id="package-installation">Package installation<a class="anchor" aria-label="anchor" href="#package-installation"></a>
</h3>
<p>We recommend installing fafbseg from GitHub using the <a href="http://natverse.org/natmanager/" class="external-link">natmanager package</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install natmanager if required</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"natmanager"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"natmanager"</span><span class="op">)</span></span>
<span><span class="fu">natmanager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span>pkgs<span class="op">=</span><span class="st">"fafbseg"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flywire-setup">FlyWire setup<a class="anchor" aria-label="anchor" href="#flywire-setup"></a>
</h3>
<p>Basic steps for setting up to access FlyWire data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/fafbseg" class="external-link">fafbseg</a></span><span class="op">)</span></span>
<span><span class="co"># record your authorisation token</span></span>
<span><span class="fu"><a href="reference/flywire_set_token.html">flywire_set_token</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># install python tools required for some functionality</span></span>
<span><span class="fu"><a href="reference/simple_python.html">simple_python</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># fetch canned connectivity *and* cell type data </span></span>
<span><span class="fu"><a href="reference/download_flywire_release_data.html">download_flywire_release_data</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>note that at the time of writing (Dec 2023) <code><a href="reference/download_flywire_release_data.html">download_flywire_release_data()</a></code> targets materialisation 783 of the FlyWire dataset, fetching both annotations and connectivity information.</p>
</div>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>Detailed examples will follow in additional vignettes, but as a first motivation, this is how to do a connectivity query using precomputed data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/fafbseg" class="external-link">fafbseg</a></span><span class="op">)</span></span>
<span><span class="va">dl4df</span><span class="op">=</span><span class="fu"><a href="reference/add_celltype_info.html">flytable_meta</a></span><span class="op">(</span><span class="st">'DL4.*'</span><span class="op">)</span></span>
<span><span class="va">dl4df</span></span>
<span></span>
<span><span class="va">dl4out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/flywire_partner_summary2.html">flywire_partner_summary2</a></span><span class="op">(</span><span class="va">dl4df</span>, partners <span class="op">=</span> <span class="st">'out'</span>, threshold <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dl4out</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>The fafbseg package enables access to a number of published and many pre-publication resources. We hope that this will accelerate your science but we <strong>strongly</strong> request that you ensure that you acknowledge both the authors of this package and the original data sources to ensure that we and they can justify this free sharing of code and data.</p>
<p>For use of the proofread and annotated FlyWire dataset, please co-cite:</p>
<ul>
<li><a href="https://doi.org/10.1101/2023.06.27.546656" class="external-link">Dorkenwald et al 2023</a></li>
<li><a href="https://doi.org/10.1101/2023.06.27.546055" class="external-link">Schlegel et al. 2023</a></li>
</ul>
<p>To acknowledge specific FAFB resources:</p>
<ul>
<li>For the FAFB dataset, <a href="https://www.cell.com/cell/fulltext/S0092-8674(18)30787-6" class="external-link">Zheng et al Cell 2018</a>
</li>
<li>For the FFN1 autosegmentation, <a href="https://www.biorxiv.org/content/10.1101/605634v3" class="external-link">Li et al bioRxiv 2019</a>
</li>
<li>For the FlyWire autosegmentation, <a href="https://%20https://doi.org/10.1038/s41592-021-01330-0" class="external-link">Dorkenwald et al Nat Meth 2022</a> and <a href="https://flywire.ai" class="external-link uri">https://flywire.ai</a>
</li>
<li>For the Buhmann synaptic connection autosegmentation, <a href="https://doi.org/10.1038/s41592-021-01183-7" class="external-link">Buhmann et al Nat Meth 2021</a>
<ul>
<li>if using the <code>cleft_score</code> metric please also cite <a href="https://link.springer.com/chapter/10.1007%2F978-3-030-00934-2_36" class="external-link">Heinrich et al 2018</a>
</li>
</ul>
</li>
<li>For the neurotransmitter prediction, <a href="https://www.biorxiv.org/content/10.1101/2020.06.12.148775" class="external-link">Eckstein et al. 2023 bioRxiv</a>
</li>
</ul>
<p>FlyWire coordinate transforms and synapse predictions make use of infrastructure contributed by Davi Bock, Gregory Jefferis, Philipp Schlegel and Eric Perlman, supported by NIH BRAIN Initiative (grant 1RF1MH120679-01); additional work including assembling ground truth data was also supported by Wellcome trust (203261/Z/16/Z).</p>
<p>For the fabseg package itself, please include a reference to the github page in your methods section as well as a citation to <a href="https://doi.org/10.7554/eLife.53350" class="external-link">Bates et al eLife 2020</a> along with the statement:</p>
<blockquote>
<p>Development of the natverse including the fafbseg package has been supported by the NIH BRAIN Initiative (grant 1RF1MH120679-01), NSF/MRC Neuronex2 (NSF 2014862/MC_EX_MR/T046279/1) and core funding from the Medical Research Council (MC_U105188491).</p>
</blockquote>
<p><strong>Thank you!</strong></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/natverse/fafbseg/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/natverse/fafbseg/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fafbseg</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Gregory Jefferis <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0587-9355" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://natverse.github.io" class="external-link"><img src="https://img.shields.io/badge/natverse-Part%20of%20the%20natverse-a241b6" alt="natverse"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/natverse/fafbseg/releases/latest" class="external-link"><img src="https://img.shields.io/github/release/natverse/fafbseg.svg" alt="Release Version"></a></li>
<li><a href="https://natverse.github.io/fafbseg/reference/" class="external-link"><img src="https://img.shields.io/badge/docs-100%25-brightgreen.svg" alt="Docs"></a></li>
<li><a href="https://github.com/natverse/fafbseg/actions" class="external-link"><img src="https://github.com/natverse/fafbseg/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/natverse/fafbseg?branch=master" class="external-link"><img src="https://codecov.io/gh/natverse/fafbseg/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
