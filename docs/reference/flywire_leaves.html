<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find all the supervoxel (leaf) ids that are part of a FlyWire object — flywire_leaves • fafbseg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find all the supervoxel (leaf) ids that are part of a FlyWire object — flywire_leaves"><meta property="og:description" content="This workhorse function underlies the ability to define synaptic
  connections and neurotransmitter predictions for flywire neurons."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fafbseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAFB-FlyWire.html">FAFB-FlyWire</a>
    </li>
    <li>
      <a href="../articles/accessing-graphene-server.html">Accessing the chunked graph server</a>
    </li>
    <li>
      <a href="../articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a>
    </li>
    <li>
      <a href="../articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a>
    </li>
    <li>
      <a href="../articles/mesh-to-mesh.html">Mesh to mesh distances</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../SUPPORT.html">Help</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.org/" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/fafbseg" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find all the supervoxel (leaf) ids that are part of a FlyWire object</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/fafbseg/blob/HEAD/R/flywire-api.R" class="external-link"><code>R/flywire-api.R</code></a></small>
    <div class="hidden name"><code>flywire_leaves.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This workhorse function underlies the ability to define synaptic
  connections and neurotransmitter predictions for flywire neurons.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">flywire_leaves</span><span class="op">(</span>
  <span class="va">x</span>,
  cloudvolume.url <span class="op">=</span> <span class="cn">NULL</span>,
  integer64 <span class="op">=</span> <span class="cn">FALSE</span>,
  mip <span class="op">=</span> <span class="fl">0L</span>,
  bbox <span class="op">=</span> <span class="cn">NULL</span>,
  cache <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>One or more FlyWire segment ids</p></dd>
<dt>cloudvolume.url</dt>
<dd><p>URL for CloudVolume to fetch segmentation image data.
The default value of NULL chooses the flywire production segmentation
dataset.</p></dd>
<dt>integer64</dt>
<dd><p>Whether to return ids as integer64 type (the default, more
compact but a little fragile) rather than character (when <code>FALSE</code>).</p></dd>
<dt>mip</dt>
<dd><p>The mip level for the segmentation (expert use only)</p></dd>
<dt>bbox</dt>
<dd><p>The bounding box within which to find supervoxels (default =
<code>NULL</code> for whole brain. Expert use only.)</p></dd>
<dt>cache</dt>
<dd><p>Whether to cache the results of flywire_leaves calls. See
details.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed to <code>pbsapply</code> and
eventually <code><a href="flywire_fetch.html">flywire_fetch</a></code> when <code>method="flywire"</code> OR to
<code>cv$CloudVolume</code> when <code>method="cloudvolume"</code></p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>By default repeated calls to <code>flywire_leaves</code> are cached on
  disk. This functionality is provided by the <code>cachem</code> package now used
  by the <code>memoise</code> package. By default the cache will expand up to 1.5GB
  and then start pruning on a least recently used basis (LRU). 1.5GB might
  store 10-20,000 results for <code>flywire_leaves</code> calls depending on the
  size of the corresponding neurons.</p>
<p>Since each root id can map to hundreds of thousands of supervoxel ids,
  there are space implications. In order to save space, the results are
  stored as compressed 64 bit integers (which are ~30x smaller than character
  vectors). The compression step does add an extra ~ 5<!-- % time on a cache miss -->
  but is 100x + faster on a cache hit. The default compression is based on
  the suggested brotli library if available, gzip otherwise.</p>
<p>There is functionality for a memory cache on top of the disk cache, but
  this is not currently exposed as the disk read time appears small compared
  with the time for uncompressing and other overheads.</p>
<p>The cache can be controlled by two package options:</p>
<p></p><ul><li><p><code>fafbseg.cachedir</code> The location on disk. If not previously set,
  it is set to an appropriate user folder on package load using
  <code>rappdirs::<a href="https://rdrr.io/pkg/rappdirs/man/user_data_dir.html" class="external-link">user_data_dir</a></code>. Note that the cache for
  this function will be located inside a folder called <code>flywire_leaves</code>.</p></li>
<li><p><code>fafbseg.flcachesize</code> The maximum cache size in bytes. When the
  storage space exceeds this results are pruned using a LRU algorithm.
  Defaults to <code>1.5 * 1024^3</code> when unset.</p></li>
</ul><p>Note that the default configuration means that the cache will be shared for
  a given user across R sessions. It is worth bearing in mind the possibility
  of race conditions if multiple applications are writing/pruning the cache.
  For example if the <code>fafbseg.flcachesize</code> has different values in
  different sessions, the session with the smallest value will start pruning
  files on disk before the other session.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other flywire-ids: 
<code><a href="flywire_islatest.html">flywire_islatest</a>()</code>,
<code><a href="flywire_last_modified.html">flywire_last_modified</a>()</code>,
<code><a href="flywire_latestid.html">flywire_latestid</a>()</code>,
<code><a href="flywire_rootid.html">flywire_rootid</a>()</code>,
<code><a href="flywire_updateids.html">flywire_updateids</a>()</code>,
<code><a href="flywire_xyz2id.html">flywire_xyz2id</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="va">kcid</span><span class="op">=</span><span class="st">"720575940623755722"</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">flywire_leaves</span><span class="op">(</span><span class="va">kcid</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8536</span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># developer function to check cache status</span></span>
<span class="r-in"><span class="fu">fafbseg</span><span class="fu">:::</span><span class="fu">flywire_leaves_cache_info</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

