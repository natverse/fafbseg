<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find the input/output partners for a flywire neuron — flywire_partners • fafbseg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find the input/output partners for a flywire neuron — flywire_partners"><meta property="og:description" content="flywire_partners is a low level function returning one
  row for every synapse.
flywire_partner_summary summarises the connectivity of
  one or more flywire neurons."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fafbseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAFB-FlyWire.html">FAFB-FlyWire</a>
    </li>
    <li>
      <a href="../articles/accessing-graphene-server.html">Accessing the chunked graph server</a>
    </li>
    <li>
      <a href="../articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a>
    </li>
    <li>
      <a href="../articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a>
    </li>
    <li>
      <a href="../articles/mesh-to-mesh.html">Mesh to mesh distances</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../SUPPORT.html">Help</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.org/" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/fafbseg" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the input/output partners for a flywire neuron</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/fafbseg/blob/HEAD/R/autosyn.R" class="external-link"><code>R/autosyn.R</code></a></small>
    <div class="hidden name"><code>flywire_partners.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>flywire_partners</code> is a low level function returning one
  row for every synapse.</p>
<p><code>flywire_partner_summary</code> summarises the connectivity of
  one or more flywire neurons.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flywire_partners</span><span class="op">(</span></span>
<span>  <span class="va">rootids</span>,</span>
<span>  partners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outputs"</span>, <span class="st">"inputs"</span>, <span class="st">"both"</span><span class="op">)</span>,</span>
<span>  details <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  roots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"either"</span>, <span class="st">"FAFB14"</span>, <span class="st">"FlyWire"</span><span class="op">)</span>,</span>
<span>  cloudvolume.url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"spine"</span>, <span class="st">"sqlite"</span><span class="op">)</span>,</span>
<span>  Verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  local <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">flywire_partner_summary</span><span class="op">(</span></span>
<span>  <span class="va">rootids</span>,</span>
<span>  partners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outputs"</span>, <span class="st">"inputs"</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  remove_autapses <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cleft.threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  summarise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  surf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"spine"</span>, <span class="st">"sqlite"</span>, <span class="st">"cave"</span><span class="op">)</span>,</span>
<span>  Verbose <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  local <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rootids</dt>
<dd><p>Character vector specifying one or more flywire rootids. As a
convenience for <code>flywire_partner_summary</code> this argument is passed to
<code><a href="flywire_ids.html">flywire_ids</a></code> allowing you to pass in data.frames, flywire URLs
or cell type queries.</p></dd>


<dt>partners</dt>
<dd><p>Whether to fetch input or output synapses or both.</p></dd>


<dt>details</dt>
<dd><p>Whether to include additional details such as X Y Z location
(default <code>FALSE</code>)</p></dd>


<dt>roots</dt>
<dd><p>Whether to fetch the flywire rootids of the partner neurons
(default <code>TRUE</code>)</p></dd>


<dt>reference</dt>
<dd><p>A character vector or a <code>templatebrain</code> object
specifying the reference template brain for any 3D coordinate information.
The default value of <code>"either"</code> will use the natural reference space
of the data source (FAFB14 for SQLite tables, FlyWire for the spine
service).</p></dd>


<dt>cloudvolume.url</dt>
<dd><p>The segmentation source URL for cloudvolume. Normally
you can ignore this and rely on the default segmentation chosen by
<code><a href="choose_segmentation.html">choose_segmentation</a></code></p></dd>


<dt>method</dt>
<dd><p>Whether to use a local SQLite database or remote spine service
for synapse data. The default <code>auto</code> uses a local database when
available (45GB but faster).</p></dd>


<dt>Verbose</dt>
<dd><p>Whether to print status messages</p></dd>


<dt>local</dt>
<dd><p>path to SQLite synapse data. Evaluated by
<code>fafbseg:::local_or_google</code>. Work in progress. Default is to download
this data and place it in <code>~/projects/JanFunke</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code>pbsapply</code></p></dd>


<dt>threshold</dt>
<dd><p>For <code>flywire_partner_summary</code> only return partners with
greater than this number of connections to the query neuron(s) (default of
0 returns all connections)</p></dd>


<dt>remove_autapses</dt>
<dd><p>For <code>flywire_partner_summary</code> whether to remove
autapses (defaults to TRUE)</p></dd>


<dt>cleft.threshold</dt>
<dd><p>A threshold for the cleft score calculated by Buhmann
et al 2019 (default 0, we have used 30-100 to increase specificity)</p></dd>


<dt>summarise</dt>
<dd><p>Whether to collapse down the results for multiple query
neurons into a single entry for each partner neuron.</p></dd>


<dt>surf</dt>
<dd><p>An object defining a 3D ROI inside which the presynaptic position
must be located. Can be a <code>mesh3d</code> object, or any object which
<code><a href="https://rdrr.io/pkg/nat/man/as.mesh3d.html" class="external-link">as.mesh3d</a></code> can handle including <code><a href="https://rdrr.io/pkg/nat/man/read.hxsurf.html" class="external-link">hxsurf</a></code> and
<code><a href="https://rdrr.io/pkg/nat/man/boundingbox.html" class="external-link">boundingbox</a></code> objects. See <code><a href="https://rdrr.io/pkg/nat/man/pointsinside.html" class="external-link">pointsinside</a></code> for
details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.frame</code> with a <code>regtemplate</code> attribute specifying
  the reference brain space for any xyz points. Columns vary slightly
  depending on whether data is fetched from spine/ITANNA or a local sqlite
  database. The more obscure ones include:</p>
<p></p>
<ul><li><p><code>prepost</code> When <code>partners = "both"</code> then this column will be
  present. For any given row (synapse), <code>prepost=1</code> when the initial
  query neuron is downstream (postsynaptic) and the partner is upstream.</p></li>
<li><p><code>score</code> came straight from Buhmann et al and is supposed to
  indicate some confidence score for the predicted synapse.</p></li>
<li><p><code>cleft_score</code> is the more useful one and was a later addition by
  Stephan Gerhard that asks whether the pre and post synapses are positioned
  at sensible distances on each side of a cleft defined by a separate neural
  network from Larissa Heinrich in Stephan Saalfeld’s group.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>FIXME behaviour when there are no partners is not well-defined.</p>
<p>Note that there are many duplicated connections in this raw output, false
  autapses (i.e. the same neuron connected to itself) and other false
  positives. See Buhmann et al for details and ideas about cleaning up the
  results.</p>
<p>Also note that the ids returned are of the class <code>integer64</code> for
  <code>flywire_partners</code> where there is one row for each
  synapses/connection; but for <code>flywire_partner_summary</code> where rows
  report the number of connections between pairs of neurons, they are of type
  <code>character</code>. This is because the <code>integer64</code> type is more compact
  but less robust because it is not a base R type but instead provided by the
  <code>bit64</code> package. Some R functions such as <code>sapply</code> strip the
  class from <code>integer64</code> vectors, treating them as doubles of a
  completely different value.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other automatic-synapses: 
<code><a href="flywire_adjacency_matrix.html">flywire_adjacency_matrix</a>()</code>,
<code><a href="flywire_neurons_add_synapses.html">flywire_neurons_add_synapses</a>()</code>,
<code><a href="flywire_ntplot.html">flywire_ntplot</a>()</code>,
<code><a href="flywire_ntpred.html">flywire_ntpred</a>()</code></p>
<p>Other automatic-synapses: 
<code><a href="flywire_adjacency_matrix.html">flywire_adjacency_matrix</a>()</code>,
<code><a href="flywire_neurons_add_synapses.html">flywire_neurons_add_synapses</a>()</code>,
<code><a href="flywire_ntplot.html">flywire_ntplot</a>()</code>,
<code><a href="flywire_ntpred.html">flywire_ntpred</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">pp</span><span class="op">=</span><span class="fu">flywire_partners</span><span class="op">(</span><span class="st">"720575940621039145"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching supervoxel ids for id: 720575940621039145</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding synapses for supervoxels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching root ids</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    offset          pre_svid         post_svid            post_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  152196 81491472725509269 81491472725509199 720575940631693610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  828599 81561978908660664 81561978908653994 720575940632985261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  828625 81561978908669037 81561978908667521 720575940589754844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1236913 81631042385463742 81631042385462154 720575940631693610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1236914 81631042385459399 81631042385454876 720575940631693610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1236915 81631042385462087 81631042385470852 720575940631693610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               pre_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 720575940621039145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 720575940621039145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 720575940621039145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 720575940621039145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 720575940621039145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 720575940621039145</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">post_id</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "integer64"</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Note that post_id is of type character</span></span></span>
<span class="r-in"><span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="st">"720575940621039145"</span>, partners<span class="op">=</span><span class="st">'out'</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching supervoxel ids for id: 720575940621039145</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding synapses for supervoxels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching root ids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,215 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    post_id            weight     n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 720575940631693610    891     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 720575940618522433    172     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 720575940622838154     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 720575940631200327     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 720575940631914700     34     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 720575940628412732     31     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 720575940619553671     30     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 720575940621000831     29     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 720575940611428761     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 720575940624743946     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 1,205 more rows</span></span>
<span class="r-in"><span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="st">"720575940621039145"</span>, partners<span class="op">=</span><span class="st">'in'</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching supervoxel ids for id: 720575940621039145</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding synapses for supervoxels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching root ids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 621 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pre_id             weight     n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 720575940631693610    891     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 720575940613380914     90     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 720575940631842360     88     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 720575940621000831     77     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 720575940605252128     74     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 720575940631200327     69     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 720575940622337635     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 720575940631061561     60     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 720575940635047672     57     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 720575940621717469     56     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 611 more rows</span></span>
<span class="r-in"><span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="st">"720575940621039145"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching supervoxel ids for id: 720575940621039145</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding synapses for supervoxels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching root ids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,215 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    post_id            weight     n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 720575940631693610    891     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 720575940618522433    172     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 720575940622838154     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 720575940631200327     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 720575940631914700     34     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 720575940628412732     31     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 720575940619553671     30     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 720575940621000831     29     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 720575940611428761     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 720575940624743946     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 1,205 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary for neuron at a XYZ location (in this case in raw coordinates)</span></span></span>
<span class="r-in"><span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="fu"><a href="flywire_xyz2id.html">flywire_xyz2id</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">155682</span>, <span class="fl">58180</span>, <span class="fl">3215</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rawcoords <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching supervoxel ids for id: 720575940631693610</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding synapses for supervoxels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fetching root ids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,214 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    post_id            weight     n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 720575940618522433    172     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 720575940622838154     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 720575940631200327     62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 720575940631914700     34     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 720575940628412732     31     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 720575940619553671     30     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 720575940621000831     29     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 720575940611428761     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 720575940624743946     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 720575940635031962     27     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 1,204 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Use Ctrl+Shift+J to share a flywire scene and then do this to get partner</span></span></span>
<span class="r-in"><span><span class="co"># summary for that URL</span></span></span>
<span class="r-in"><span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="fu">clipr</span><span class="fu">::</span><span class="fu"><a href="http://matthewlincoln.net/clipr/reference/read_clip.html" class="external-link">read_clip</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cct</span><span class="op">=</span><span class="fu"><a href="flywire_cave_query.html">flywire_cave_query</a></span><span class="op">(</span><span class="st">'cambridge_celltypes'</span>, live <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dl1.lh</span><span class="op">=</span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="va">cct</span><span class="op">$</span><span class="va">pt_root_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"DL1"</span>, <span class="va">cct</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  surf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">elmr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/elmr/man/FAFB.surf.html" class="external-link">FAFB14NP.surf</a></span>, <span class="st">"LH_R"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># use a rectangular bounding box around LH instead</span></span></span>
<span class="r-in"><span><span class="va">dl1.lhbb</span><span class="op">=</span><span class="fu">flywire_partner_summary</span><span class="op">(</span><span class="va">cct</span><span class="op">$</span><span class="va">pt_root_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"DL1"</span>, <span class="va">cct</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  surf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/boundingbox.html" class="external-link">boundingbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">elmr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/elmr/man/FAFB.surf.html" class="external-link">FAFB14NP.surf</a></span>, <span class="st">"LH_R"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

