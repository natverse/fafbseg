<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get a complete flytable table with disk caching and delta sync — flytable_cached_table • fafbseg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get a complete flytable table with disk caching and delta sync — flytable_cached_table"><meta name="description" content="Fetches a complete flytable table using disk caching with
  intelligent delta synchronization. On first call, downloads the full table.
  On subsequent calls within expiry seconds, returns cached data.
  After expiry, performs delta sync fetching only rows modified since last
  sync based on the _mtime column."><meta property="og:description" content="Fetches a complete flytable table using disk caching with
  intelligent delta synchronization. On first call, downloads the full table.
  On subsequent calls within expiry seconds, returns cached data.
  After expiry, performs delta sync fetching only rows modified since last
  sync based on the _mtime column."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fafbseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/accessing-graphene-server.html">Accessing the chunked graph server</a></li>
    <li><a class="dropdown-item" href="../articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a></li>
    <li><a class="dropdown-item" href="../articles/FAFB-FlyWire.html">FAFB-FlyWire</a></li>
    <li><a class="dropdown-item" href="../articles/fafbseg-catmaid-legacy-info.html">fafbseg-catmaid-legacy-info</a></li>
    <li><a class="dropdown-item" href="../articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a></li>
    <li><a class="dropdown-item" href="../articles/mesh-to-mesh.html">Mesh to mesh distances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../SUPPORT.html">Help</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://natverse.org/">natverse</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natverse/fafbseg"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get a complete flytable table with disk caching and delta sync</h1>
      <small class="dont-index">Source: <a href="https://github.com/natverse/fafbseg/blob/master/R/flytable-cache.R" class="external-link"><code>R/flytable-cache.R</code></a></small>
      <div class="d-none name"><code>flytable_cached_table.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fetches a complete flytable table using disk caching with
  intelligent delta synchronization. On first call, downloads the full table.
  On subsequent calls within <code>expiry</code> seconds, returns cached data.
  After expiry, performs delta sync fetching only rows modified since last
  sync based on the <code>_mtime</code> column.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flytable_cached_table</span><span class="op">(</span></span>
<span>  <span class="va">table</span>,</span>
<span>  expiry <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  refresh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  collapse_lists <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  base <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">100000L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-table">table<a class="anchor" aria-label="anchor" href="#arg-table"></a></dt>
<dd><p>Table name (e.g., "info", "optic", "testfruit")</p></dd>


<dt id="arg-expiry">expiry<a class="anchor" aria-label="anchor" href="#arg-expiry"></a></dt>
<dd><p>Seconds before checking for updates (default 300 = 5 minutes).
Set to 0 to always check for updates, <code>Inf</code> to never check.</p></dd>


<dt id="arg-refresh">refresh<a class="anchor" aria-label="anchor" href="#arg-refresh"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, forces a complete re-download
ignoring any cached data. Default <code>FALSE</code>.</p></dd>


<dt id="arg-collapse-lists">collapse_lists<a class="anchor" aria-label="anchor" href="#arg-collapse-lists"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), collapses
multi-select columns into comma-separated strings. Passed to
<code><a href="flytable-queries.html">flytable_query</a></code>.</p></dd>


<dt id="arg-base">base<a class="anchor" aria-label="anchor" href="#arg-base"></a></dt>
<dd><p>Optional base name if table name is ambiguous (exists in multiple
bases).</p></dd>


<dt id="arg-limit">limit<a class="anchor" aria-label="anchor" href="#arg-limit"></a></dt>
<dd><p>An optional limit, which only applies if you do not specify a
limit directly in the <code>sql</code> query. By default seatable limits SQL
queries to 100 rows. We increase the limit to 100000 rows by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> containing all rows from the table. Has an
  <code>mtime</code> attribute recording the server timestamp at last sync.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses the same disk cache infrastructure as
  <code><a href="flywire_leaves.html">flywire_leaves</a></code>. The cache location can be controlled via the
  <code>fafbseg.cachedir</code> option.</p>
<p>Delta synchronization works by:</p><ol><li><p>Checking if cached data exists and is within the expiry window</p></li>
<li><p>If expired, querying rows where <code>_mtime &gt; cached_mtime</code></p></li>
<li><p>Updating modified rows, appending new rows</p></li>
<li><p>Detecting and removing deleted rows via row count comparison</p></li>
</ol><p>Error handling:</p><ul><li><p>Connection failures during sync: returns cached data with warning</p></li>
<li><p>Schema changes (columns differ): forces full refresh</p></li>
<li><p>Corrupted cache: clears and re-fetches</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="flytable-queries.html">flytable_query</a></code>, <code><a href="flytable-queries.html">flytable_list_rows</a></code></p>
<p>Other flytable:
<code><a href="flytable-queries.html">flytable-queries</a></code>,
<code><a href="flytable_list_selected.html">flytable_list_selected()</a></code>,
<code><a href="flytable_login.html">flytable_login()</a></code>,
<code><a href="flytable_update_rows.html">flytable_update_rows()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># First call - full fetch</span></span></span>
<span class="r-in"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu">flytable_cached_table</span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subsequent call within 5 min - returns cached data</span></span></span>
<span class="r-in"><span><span class="va">info2</span> <span class="op">&lt;-</span> <span class="fu">flytable_cached_table</span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force check for updates (ignores expiry window)</span></span></span>
<span class="r-in"><span><span class="va">info3</span> <span class="op">&lt;-</span> <span class="fu">flytable_cached_table</span><span class="op">(</span><span class="st">"info"</span>, expiry <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force complete re-download</span></span></span>
<span class="r-in"><span><span class="va">info4</span> <span class="op">&lt;-</span> <span class="fu">flytable_cached_table</span><span class="op">(</span><span class="st">"info"</span>, refresh <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check when data was last synced</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">info</span>, <span class="st">"mtime"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

