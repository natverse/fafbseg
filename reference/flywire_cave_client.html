<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Low level access to the Flywire CAVE annotation system — flywire_cave_client • fafbseg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Low level access to the Flywire CAVE annotation system — flywire_cave_client"><meta name="description" content="Low level access to the Flywire CAVE annotation system"><meta property="og:description" content="Low level access to the Flywire CAVE annotation system"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fafbseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/accessing-graphene-server.html">Accessing the chunked graph server</a></li>
    <li><a class="dropdown-item" href="../articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a></li>
    <li><a class="dropdown-item" href="../articles/FAFB-FlyWire.html">FAFB-FlyWire</a></li>
    <li><a class="dropdown-item" href="../articles/fafbseg-catmaid-legacy-info.html">fafbseg-catmaid-legacy-info</a></li>
    <li><a class="dropdown-item" href="../articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a></li>
    <li><a class="dropdown-item" href="../articles/mesh-to-mesh.html">Mesh to mesh distances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../SUPPORT.html">Help</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://natverse.org/">natverse</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natverse/fafbseg"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Low level access to the Flywire CAVE annotation system</h1>
      <small class="dont-index">Source: <a href="https://github.com/natverse/fafbseg/blob/master/R/cave.R" class="external-link"><code>R/cave.R</code></a></small>
      <div class="d-none name"><code>flywire_cave_client.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Low level access to the Flywire CAVE annotation system</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flywire_cave_client</span><span class="op">(</span></span>
<span>  datastack_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"fafbseg.cave.datastack_name"</span>, <span class="st">"flywire_fafb_production"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-datastack-name">datastack_name<a class="anchor" aria-label="anchor" href="#arg-datastack-name"></a></dt>
<dd><p>defaults to the value selected by
<code><a href="choose_segmentation.html">choose_segmentation</a></code> and to "flywire_fafb_production" when
that is missing. See <a href="https://global.daf-apis.com/info/" class="external-link">https://global.daf-apis.com/info/</a> for other
options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>caveclient.frameworkclient.CAVEclientFull</code> Python module
  wrapped by reticulate.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This depends on installation of the Python caveclient library. See
  <code><a href="flywire_cave_query.html">flywire_cave_query</a></code> for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">fac</span> <span class="op">&lt;-</span> <span class="fu">flywire_cave_client</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fac</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="fu">get_tables</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "synapses_v2"                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "synapses_v2_neuropil_v6"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "fly_synapses_neuropil_v2"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "synaptic_clefts"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "hierarchical_neuron_annotations"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "fly_synapses_neuropil_v6"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "neuron_information_v2"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "cambridge_celltypes_v2"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "fly_synapses_neuropil_v5"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "neuron_information_vtest"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "proofreading_status_public_v1"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "synapses_nt_v1"                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "fly_synapses_neuropil"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "proofreading_review_public_vtest"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "braincircuits_annotation_test"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "valid_synapses_nt_vtest"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "neuron_information_v1"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "nuclei_v1"                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "valid_synapses_nt_v2"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "valid_synapses_nt_v1"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "fly_synapses_neuropil_v4"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "hemilineages"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "braincircuits_annotation_test2"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "hemibrain_matched_types"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "neuron_representative_coordinates_v1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "hierarchical_cell_types_v1"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "cambridge_celltypes"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "fly_synapses_neuropil_v3"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "proofreading_review_public_v1"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30] "proofread_neurons"                   </span>
<span class="r-in"><span><span class="va">fac</span><span class="op">$</span><span class="va">annotation</span><span class="op">$</span><span class="fu">get_table_metadata</span><span class="op">(</span><span class="st">'nuclei_v1'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $schema_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nucleus_detection"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $table_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nuclei_v1__fly_v31"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $valid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $created</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2021-08-13T18:01:55.211016"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $deleted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $user_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "\nFlyWire nucleus description\nNucleus version: 20210322\n\nNuclei in this table consist of center points (in nm), volume (in μm3), and bounding boxes (in nm).\n\nThe nucleus segmentation was generated by Shang Mu (smu@princeton.edu, Seung Lab at Princeton University) using a 2D convolutional neural network (CNN) and heuristic interpolations. The training data was assembled from annotations by Selden Koolman, Merlin Moore, Sarah Morejohn, Ben Silverman, Kyle Willie, Ryan Willie, Szi-chieh Yu and Shang Mu.\n\nAs this data was generated using a 2D, rather than 3D, neural network, defects are present in the detected nuclei, particularly where there are large defects in section alignment or a number of consecutive missing sections.\n\nFalse positive fragments, nucleus fragments and partial nuclei are the most common type of defects. A simple, rudimentary method for cleaning up is to disregard small fragments by thresholding by segment size or by the z-dimension of the bounding boxes. A size threshold of 2000 voxels (0.08 μm3) was already applied in producing this segmentation.\n\nA minimal number of nucleus merger instances have been observed, caused by section alignment defects or close nuclei appositions in certain non-neuronal cell clusters.\n\nWhen using the nucleus annotations, please acknowledge Shang Mu and let him know about your use case.\n\nWe encourage making (and using) improvements to this data based on the information provided (for example, utilizing bounding box dimensions and/or the segmentation to find and merge incorrectly split partial nuclei), and such improvements should be discussed with Shang. Data derived solely from this work should be similarly made available on this platform at the time of use in any publication.\n"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $notice_text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $reference_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $flat_segmentation_source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "precomputed://gs://neuroglancer/drosophila_v0/nucleus/v5_z_intp_intp/seg"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $write_permission</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PRIVATE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $read_permission</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PUBLIC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $last_modified</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2022-10-25T19:49:21.621037"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $segmentation_source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] ""</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pcg_table_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fly_v31"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $last_updated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2025-02-01T05:10:01.247986"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $annotation_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nuclei_v1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $voxel_resolution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># annotation tables that have been materialised in order to map XYZ</span></span></span>
<span class="r-in"><span><span class="co"># points onto current root ids (and immutable supervoxel ids)</span></span></span>
<span class="r-in"><span><span class="co"># typically the same as fac$annotation$get_tables()</span></span></span>
<span class="r-in"><span><span class="va">fac</span><span class="op">$</span><span class="va">materialize</span><span class="op">$</span><span class="fu">get_tables</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "synapses_v2"                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "synapses_v2_neuropil_v6"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "fly_synapses_neuropil_v2"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "synaptic_clefts"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "hierarchical_neuron_annotations"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "fly_synapses_neuropil_v6"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "neuron_information_v2"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "cambridge_celltypes_v2"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "fly_synapses_neuropil_v5"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "neuron_information_vtest"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "proofreading_status_public_v1"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "synapses_nt_v1"                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "fly_synapses_neuropil"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "proofreading_review_public_vtest"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "braincircuits_annotation_test"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "valid_synapses_nt_vtest"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "nuclei_v1"                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "valid_synapses_nt_v2"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "valid_synapses_nt_v1"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "fly_synapses_neuropil_v4"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "hemilineages"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "neuron_representative_coordinates_v1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "cambridge_celltypes"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "fly_synapses_neuropil_v3"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "proofreading_review_public_v1"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "proofread_neurons"                   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">info</span><span class="op">=</span><span class="va">fac</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="fu">get_datastack_info</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the default synapse table for the dataset</span></span></span>
<span class="r-in"><span><span class="va">info</span><span class="op">$</span><span class="va">synapse_table</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "synapses_nt_v1"</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># get help on python cave client</span></span></span>
<span class="r-in"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_help.html" class="external-link">py_help</a></span><span class="op">(</span><span class="va">fac</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">get_datastack_info</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

