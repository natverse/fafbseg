<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find all the supervoxel (leaf) ids that are part of a FlyWire object — flywire_leaves • fafbseg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find all the supervoxel (leaf) ids that are part of a FlyWire object — flywire_leaves"><meta name="description" content="This workhorse function underlies the ability to define synaptic
  connections and neurotransmitter predictions for flywire neurons."><meta property="og:description" content="This workhorse function underlies the ability to define synaptic
  connections and neurotransmitter predictions for flywire neurons."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fafbseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/accessing-graphene-server.html">Accessing the chunked graph server</a></li>
    <li><a class="dropdown-item" href="../articles/capturing-ngl-meshes.html">Capturing neuroglancer meshes from a browser scene</a></li>
    <li><a class="dropdown-item" href="../articles/FAFB-FlyWire.html">FAFB-FlyWire</a></li>
    <li><a class="dropdown-item" href="../articles/fafbseg-catmaid-legacy-info.html">fafbseg-catmaid-legacy-info</a></li>
    <li><a class="dropdown-item" href="../articles/installing-cloudvolume-meshparty.html">Installing python modules: cloudvolume, meshparty and skeletor</a></li>
    <li><a class="dropdown-item" href="../articles/mesh-to-mesh.html">Mesh to mesh distances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../SUPPORT.html">Help</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://natverse.org/">natverse</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natverse/fafbseg"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find all the supervoxel (leaf) ids that are part of a FlyWire object</h1>
      <small class="dont-index">Source: <a href="https://github.com/natverse/fafbseg/blob/master/R/flywire-api.R" class="external-link"><code>R/flywire-api.R</code></a></small>
      <div class="d-none name"><code>flywire_leaves.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This workhorse function underlies the ability to define synaptic
  connections and neurotransmitter predictions for flywire neurons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flywire_leaves</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  cloudvolume.url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  integer64 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mip <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  bbox <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>One or more FlyWire segment ids</p></dd>


<dt id="arg-cloudvolume-url">cloudvolume.url<a class="anchor" aria-label="anchor" href="#arg-cloudvolume-url"></a></dt>
<dd><p>URL for CloudVolume to fetch segmentation image data.
The default value of NULL chooses the flywire production segmentation
dataset.</p></dd>


<dt id="arg-integer-">integer64<a class="anchor" aria-label="anchor" href="#arg-integer-"></a></dt>
<dd><p>Whether to return ids as integer64 type (the default, more
compact but a little fragile) rather than character (when <code>FALSE</code>).</p></dd>


<dt id="arg-mip">mip<a class="anchor" aria-label="anchor" href="#arg-mip"></a></dt>
<dd><p>The mip level for the segmentation (expert use only)</p></dd>


<dt id="arg-bbox">bbox<a class="anchor" aria-label="anchor" href="#arg-bbox"></a></dt>
<dd><p>The bounding box within which to find supervoxels (default =
<code>NULL</code> for whole brain. Expert use only.)</p></dd>


<dt id="arg-cache">cache<a class="anchor" aria-label="anchor" href="#arg-cache"></a></dt>
<dd><p>Whether to cache the results of flywire_leaves calls. See
details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>pbsapply</code> and
eventually <code><a href="flywire_fetch.html">flywire_fetch</a></code> when <code>method="flywire"</code> OR to
<code>cv$CloudVolume</code> when <code>method="cloudvolume"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default repeated calls to <code>flywire_leaves</code> are cached on
  disk. This functionality is provided by the <code>cachem</code> package now used
  by the <code>memoise</code> package. By default the cache will expand up to 1.5GB
  and then start pruning on a least recently used basis (LRU). 1.5GB might
  store 10-20,000 results for <code>flywire_leaves</code> calls depending on the
  size of the corresponding neurons.</p>
<p>Since each root id can map to hundreds of thousands of supervoxel ids,
  there are space implications. In order to save space, the results are
  stored as compressed 64 bit integers (which are ~30x smaller than character
  vectors). The compression step does add an extra ~ 5<!-- % time on a cache miss -->
  but is 100x + faster on a cache hit. The default compression is based on
  the suggested brotli library if available, gzip otherwise.</p>
<p>There is functionality for a memory cache on top of the disk cache, but
  this is not currently exposed as the disk read time appears small compared
  with the time for uncompressing and other overheads.</p>
<p>The cache can be controlled by two package options:</p>
<p></p><ul><li><p><code>fafbseg.cachedir</code> The location on disk. If not previously set,
  it is set to an appropriate user folder on package load using
  <code>rappdirs::<a href="https://rappdirs.r-lib.org/reference/user_data_dir.html" class="external-link">user_data_dir</a></code>. Note that the cache for
  this function will be located inside a folder called <code>flywire_leaves</code>.</p></li>
<li><p><code>fafbseg.flcachesize</code> The maximum cache size in bytes. When the
  storage space exceeds this results are pruned using a LRU algorithm.
  Defaults to <code>1.5 * 1024^3</code> when unset.</p></li>
</ul><p>Note that the default configuration means that the cache will be shared for
  a given user across R sessions. It is worth bearing in mind the possibility
  of race conditions if multiple applications are writing/pruning the cache.
  For example if the <code>fafbseg.flcachesize</code> has different values in
  different sessions, the session with the smallest value will start pruning
  files on disk before the other session.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other flywire-ids:
<code><a href="flywire_islatest.html">flywire_islatest</a>()</code>,
<code><a href="flywire_last_modified.html">flywire_last_modified</a>()</code>,
<code><a href="flywire_latestid.html">flywire_latestid</a>()</code>,
<code><a href="flywire_rootid.html">flywire_rootid</a>()</code>,
<code><a href="flywire_updateids.html">flywire_updateids</a>()</code>,
<code><a href="flywire_xyz2id.html">flywire_xyz2id</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">kcid</span><span class="op">=</span><span class="st">"720575940623755722"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">flywire_leaves</span><span class="op">(</span><span class="va">kcid</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8536</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># developer function to check cache status</span></span></span>
<span class="r-in"><span><span class="fu">fafbseg</span><span class="fu">:::</span><span class="fu">flywire_leaves_cache_info</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

